/*
 * Dual-Port BRAM for Boreal Neuro-Core
 * Port A: Read-only for Weight Streaming & Activation LUT
 * Port B: Write-access for Active Inference Weight Updates (Learning)
 */

module boreal_memory #(
    parameter ADDR_WIDTH = 10,
    parameter DATA_WIDTH = 32
)(
    input  wire                  clk,
    // Port A (Inference Read)
    input  wire [ADDR_WIDTH-1:0] addr_a,
    output reg  [DATA_WIDTH-1:0] dout_a,
    
    // Port B (Learning Write/Update)
    input  wire                  we_b,
    input  wire [ADDR_WIDTH-1:0] addr_b,
    input  wire [DATA_WIDTH-1:0] din_b,
    output reg  [DATA_WIDTH-1:0] dout_b
);

    // Memory array
    reg [DATA_WIDTH-1:0] ram [0:(2**ADDR_WIDTH)-1];

    // Initialization (Load the .mem file generated by Python)
    initial begin
        $readmemh("boreal_lut.mem", ram);
    end

    // Port A: Synchronous Read
    always @(posedge clk) begin
        dout_a <= ram[addr_a];
    end

    // Port B: Synchronous Read/Write
    always @(posedge clk) begin
        if (we_b)
            ram[addr_b] <= din_b;
        dout_b <= ram[addr_b];
    end

endmodule

